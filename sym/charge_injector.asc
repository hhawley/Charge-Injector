Version 4
SHEET 1 1544 680
WIRE 656 -176 656 -192
WIRE 656 -176 624 -176
WIRE 656 -144 656 -176
WIRE 416 -112 384 -112
WIRE 528 -112 480 -112
WIRE 384 -32 384 -112
WIRE 416 -32 384 -32
WIRE 528 -32 528 -112
WIRE 528 -32 496 -32
WIRE -192 -16 -336 -16
WIRE -336 64 -336 -16
WIRE -304 64 -336 64
WIRE -192 80 -192 -16
WIRE -192 80 -240 80
WIRE -176 80 -192 80
WIRE -16 80 -96 80
WIRE 16 80 -16 80
WIRE 128 80 96 80
WIRE 384 80 384 -32
WIRE 384 80 192 80
WIRE 416 80 384 80
WIRE -528 96 -576 96
WIRE -416 96 -448 96
WIRE -304 96 -416 96
WIRE 528 96 528 -32
WIRE 528 96 480 96
WIRE 656 96 528 96
WIRE 736 96 720 96
WIRE 768 96 736 96
WIRE 1104 96 1024 96
WIRE 1168 96 1104 96
WIRE 1408 96 1328 96
WIRE 1472 96 1408 96
WIRE -576 112 -576 96
WIRE -416 112 -416 96
WIRE 416 112 384 112
WIRE 736 112 736 96
WIRE 1024 128 1024 96
WIRE 1168 128 1168 96
WIRE 1328 128 1328 96
WIRE 1472 128 1472 96
WIRE -576 208 -576 192
WIRE 384 208 384 112
WIRE -16 224 -16 80
WIRE 16 224 -16 224
WIRE 128 224 96 224
WIRE 240 224 192 224
WIRE 256 224 240 224
WIRE 256 240 256 224
WIRE 1024 240 1024 208
WIRE 1088 240 1024 240
WIRE 1168 240 1168 208
WIRE 1168 240 1088 240
WIRE 1328 240 1328 208
WIRE 1392 240 1328 240
WIRE 1472 240 1472 208
WIRE 1472 240 1392 240
WIRE 1088 256 1088 240
WIRE 1392 256 1392 240
FLAG -576 208 0
FLAG 768 96 Vout
FLAG 1088 256 0
FLAG 448 64 Vcc
FLAG 656 -64 Vss
FLAG 656 -272 Vcc
FLAG 624 -176 0
FLAG 1392 256 0
FLAG 240 224 VReal
FLAG 256 320 0
FLAG 1104 96 Qmeas
FLAG 1408 96 Qreal
FLAG 736 192 0
FLAG -416 176 0
FLAG -272 112 Vss
FLAG -272 48 Vcc
FLAG 384 288 0
FLAG 448 128 0
SYMBOL voltage -576 96 R0
WINDOW 123 -397 144 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 -397 116 Left 2
SYMATTR Value2 AC 1
SYMATTR Value PULSE(0 1 0 0 0 1000u 0 1)
SYMATTR InstName V1
SYMBOL cap 192 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {Cc}
SYMBOL res 112 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {Rsupply}
SYMBOL bv 1024 112 R0
SYMATTR InstName B1
SYMATTR Value V=idt(V(Vout))
SYMBOL res 1152 112 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL Misc\\battery 656 -288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL Misc\\battery 656 -160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 5
SYMBOL bv 1328 112 R0
SYMATTR InstName B2
SYMATTR Value V=idt(V(VReal))
SYMBOL res 1456 112 R0
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res 512 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {Rload}
SYMBOL cap 192 208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value {Cc}
SYMBOL res 112 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {Rsupply}
SYMBOL res 240 224 R0
SYMATTR InstName R7
SYMATTR Value {Rload}
SYMBOL cap 480 -128 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 3.3n
SYMBOL OpAmps\\AD8065 448 32 R0
SYMATTR InstName U2
SYMBOL cap 720 80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL res 720 96 R0
SYMATTR InstName R8
SYMATTR Value 100Meg
SYMBOL res -432 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10
SYMBOL cap -432 112 R0
SYMATTR InstName C5
SYMATTR Value 1p
SYMBOL OpAmps\\UniversalOpAmp -272 80 R0
SYMATTR InstName U1
SYMBOL voltage 384 192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 1
SYMBOL res -80 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 50
TEXT -976 368 Left 2 !;tran 0 2u 0 100p
TEXT -104 -72 Left 2 !.param Cc=9.1p Rload=49.9 Rsupply=1
TEXT 432 240 Left 2 ;V4 to be designed with a voltage reference: \nvalue does not matter as long as it is between\nthe rails of U2
TEXT 584 32 Left 2 ;Generic DC blocking. Not in the final design
TEXT -104 -40 Left 2 ;Cc 9.1p is the highest precision NPO\nI can find (0.5%)
TEXT 48 -216 Left 2 ;High C3 required: min(vout) must be below 0.5V\nbut not too big the pulse tail is longer than 5us\n(max digitizer waveform)
TEXT -976 344 Left 2 !;noise V(Vout) V1 dec 10 10 20Meg
TEXT -632 248 Left 2 ;Input stage meant to be a high-precision relay-based \nsquare wave of 1Vpp
TEXT -632 424 Left 2 ;SNR = 2.1mV /  28.057µV = 75 (peak value over std)
TEXT -976 400 Left 2 !.ac dec 50 10 200Meg
